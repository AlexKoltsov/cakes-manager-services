name: Build cakes manager services

on:
  pull_request:
    branches: [ master ]
  workflow_dispatch:

jobs:

  build-common-lib:
    uses: AlexKoltsov/cakes-manager-services/.github/workflows/build-with-maven.yml@docker-push
    with:
      artifact-name: common-lib
      is-upload-artifact: true

  build-cakes-service:
    needs: build-common-lib
    uses: AlexKoltsov/cakes-manager-services/.github/workflows/build-with-maven.yml@docker-push
    with:
      artifact-name: cakes-service
      is-download-artifact: true
      lib-name: common-lib

  build-orders-service:
    needs: build-common-lib
    uses: AlexKoltsov/cakes-manager-services/.github/workflows/build-with-maven.yml@docker-push
    with:
      artifact-name: orders-service
      is-download-artifact: true
      lib-name: common-lib

  build-people-service:
    needs: build-common-lib
    uses: AlexKoltsov/cakes-manager-services/.github/workflows/build-with-maven.yml@docker-push
    with:
      artifact-name: people-service
      is-download-artifact: true
      lib-name: common-lib

  build-service-discovery:
    uses: AlexKoltsov/cakes-manager-services/.github/workflows/build-with-maven.yml@docker-push
    with:
      artifact-name: service-discovery

  build-data-generator:
    needs: build-common-lib
    uses: AlexKoltsov/cakes-manager-services/.github/workflows/build-with-maven.yml@docker-push
    with:
      artifact-name: data-generator
      is-download-artifact: true
      lib-name: common-lib
